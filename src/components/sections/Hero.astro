---
import type { ButtonProps } from "@/components/primitives/Button.astro";
import Container from "@/components/primitives/Container.astro";
import Link from "@/components/primitives/Link.astro";
import Blob from "@/components/sections/Blob.astro";
import Countdown from "@/components/primitives/Countdown.astro";

interface Props {
  headline?: string;
  title: string;
  subtitle: string;
  buttons?: ButtonProps[];
  eventDate?: string;
  venue?: string;
  format?: string;
  imageSrc?: string;
}

const defaultButtons: ButtonProps[] = [
  {
    title: "Register Now",
    href: "/register",
    style: "button",
    icon: "iconamoon:arrow-top-right-1-thin",
  },
];

const defaultEventDate = "2025-08-28T09:00:00";
const {
  headline = '2<span class="superscript-text">nd</span> International Conference on Plastics, Innovations and Environmental Sustainability (ICPIES) 2025',
  title,
  subtitle,
  buttons = defaultButtons,
  eventDate = defaultEventDate,
  venue = "Colombo, Sri Lanka",
  format = "Hybrid Conference",
  imageSrc = "/about.png",
} = Astro.props;
---

<div
  id="hero"
  class="text-sm font-medium pb-32 pt-20 lg:pt-28 relative min-h-[85vh] bg-[#F7F7F7] overflow-hidden"
>
  <!-- Background gradient blobs with reduced opacity -->
  <div class="absolute inset-0 z-0 opacity-30">
    <div
      class="bg-animation-blob bg-[#4ECDC4] absolute top-[10%] right-[10%] w-64 h-64 rounded-full mix-blend-multiply filter blur-3xl animate-blob"
    >
    </div>
    <div
      class="bg-animation-blob bg-[#1A7A64] absolute top-[20%] left-[20%] w-72 h-72 rounded-full mix-blend-multiply filter blur-3xl animate-blob animation-delay-2000"
    >
    </div>
    <div
      class="bg-animation-blob bg-[#0D3B66] absolute bottom-[15%] left-[30%] w-80 h-80 rounded-full mix-blend-multiply filter blur-3xl animate-blob animation-delay-4000"
    >
    </div>
    <div
      class="bg-animation-blob bg-[#FF9F1C] absolute bottom-[30%] right-[20%] w-56 h-56 rounded-full mix-blend-multiply filter blur-3xl animate-blob animation-delay-6000"
    >
    </div>
  </div>

  <Container>
    <div class="flex flex-col items-center">
      <!-- Centered Hero image -->
      <div class="w-full max-w-4xl mx-auto mb-12">
        <div class="relative z-10">
          <div class="relative">
            <!-- Image container with frame -->
            <div class="relative z-10 rounded-lg overflow-hidden shadow-xl border-1 border-white">
              <img
                src={imageSrc}
                alt="ICPIES Conference 2025"
                class="w-full h-auto object-cover hero-image"
                width="1200"
                height="600"
                loading="eager"
              />
            </div>
          </div>
        </div>
      </div>

      <!-- Text content below image -->
      <div class="w-full max-w-4xl mx-auto text-center">
        <h1
          data-hero-reveal
          class="headline text-3xl md:text-4xl lg:text-4xl leading-tight mb-4 font-bold text-[#2C3E50]"
        >
          2<span class="superscript-text">nd</span> International Conference on Plastics,
          Innovations and Environmental Sustainability
        </h1>

        <h2
          data-hero-reveal
          class="title text-xl md:text-2xl leading-tight mb-4 font-semibold text-[#2C3E50]"
          set:html={title}
        />

        <p
          data-hero-reveal
          class="text-base md:text-lg font-medium mb-6 text-[#0D3B66] max-w-2xl mx-auto"
          set:html={subtitle.replace(/<u>(.*?)<\/u>/g, (_, text) => {
            if (text === "Plastics") {
              return `<span class="highlighted-text plastics-highlight">${text}</span>`;
            } else if (text === "Sustainable Future") {
              return `<span class="highlighted-text sustainable-highlight">${text}</span>`;
            }
            return `<span class="highlighted-text">${text}</span>`;
          })}
        />

        <!-- Event Badges -->
        <div class="flex flex-wrap justify-center gap-3 mb-8">
          <div
            class="venue-badge flex items-center bg-white/70 backdrop-blur-sm px-3 py-1.5 rounded-full border border-[#1A7A64]/30 shadow-sm"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-4 w-4 text-[#1A7A64] mr-2"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
              ></path>
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
            </svg>
            <span class="text-sm font-semibold text-[#2C3E50]">Colombo, Sri Lanka</span>
          </div>
          <div
            class="format-badge flex items-center bg-white/70 backdrop-blur-sm px-3 py-1.5 rounded-full border border-[#0D3B66]/30 shadow-sm "
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-4 w-4 text-[#0D3B66] mr-2"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"
              ></path>
            </svg>
            <span class="text-sm font-semibold text-[#2C3E50]">Hybrid</span>
          </div>
          <div
            class="date-badge flex items-center bg-white/70 backdrop-blur-sm px-3 py-1.5 rounded-full border border-[#FF9F1C]/30 shadow-sm"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-4 w-4 text-[#FF9F1C] mr-2"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
              />
            </svg>
            <span class="text-sm font-semibold text-[#2C3E50]">August 28-29, 2025</span>
          </div>
        </div>

        <!-- Countdown Timer in a more compact format -->
        <div data-hero-reveal class="mb-8 max-w-xl mx-auto">
          <Countdown eventDate={eventDate} />
        </div>
      </div>
    </div>
  </Container>
</div>

<style>
  @keyframes moveDown {
    0% { transform: translateY(0); }
    80% { transform: translateY(2px); }
    100% { transform: translateY(0); }
  }


  .headline {
    background: linear-gradient(90deg, #1a7a64 0%, #0d3b66 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-fill-color: transparent;
    margin-bottom: 1rem;
  }

  /* Superscript styling */
  .superscript-text {
    font-size: 0.5em;
    vertical-align: super;
    background: linear-gradient(90deg, #1a7a64 0%, #0d3b66 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-fill-color: transparent;
    font-weight: inherit;
    display: inline-block;
  }

  /* Badge hover effects */
  .venue-badge:hover, .format-badge:hover, .date-badge:hover {
    background-color: rgba(255, 255, 255, 0.9);
    transform: translateY(-2px);
  }

  .venue-badge:hover {
    box-shadow: 0 4px 6px -1px rgba(26, 122, 100, 0.15), 0 2px 4px -1px rgba(26, 122, 100, 0.1);
  }

  .format-badge:hover {
    box-shadow: 0 4px 6px -1px rgba(13, 59, 102, 0.15), 0 2px 4px -1px rgba(13, 59, 102, 0.1);
  }

  .date-badge:hover {
    box-shadow: 0 4px 6px -1px rgba(255, 159, 28, 0.15), 0 2px 4px -1px rgba(255, 159, 28, 0.1);
  }

  /* Highlighted text styling */
  .highlighted-text {
    position: relative;
    display: inline-block;
    padding: 0 2px;
    font-weight: 600;
    transition: all 0.3s ease;
  }

  /* Plastics highlight styling */
  .plastics-highlight {
    color: #0d3b66;
    background: linear-gradient(to bottom, rgba(13, 59, 102, 0.08) 50%, rgba(13, 59, 102, 0.2) 50%);
    box-decoration-break: clone;
    -webkit-box-decoration-break: clone;
  }

  .plastics-highlight:hover {
    background: linear-gradient(to bottom, rgba(13, 59, 102, 0.12) 50%, rgba(13, 59, 102, 0.25) 50%);
  }

  /* Sustainable highlight styling */
  .sustainable-highlight {
    color: #1a7a64;
    background: linear-gradient(to bottom, rgba(26, 122, 100, 0.08) 50%, rgba(26, 122, 100, 0.2) 50%);
    box-decoration-break: clone;
    -webkit-box-decoration-break: clone;
  }

  .sustainable-highlight:hover {
    background: linear-gradient(to bottom, rgba(26, 122, 100, 0.12) 50%, rgba(26, 122, 100, 0.25) 50%);
  }

  /* Animation keyframes */
  @keyframes pulse-slow {
    0%, 100% { opacity: 0.4; transform: scale(1); }
    50% { opacity: 0.7; transform: scale(1.1); }
  }

  @keyframes float-y {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-15px); }
  }

  .animate-pulse-slow {
    animation: pulse-slow 6s infinite ease-in-out;
  }

  .animate-float-y {
    animation: float-y 4s infinite ease-in-out;
  }

  /* Background blob animations */
  .bg-animation-blob {
    opacity: 0.7;
  }

  @keyframes blob {
    0% { transform: translate(0px, 0px) scale(1); }
    33% { transform: translate(30px, -50px) scale(1.1); }
    66% { transform: translate(-20px, 20px) scale(0.9); }
    100% { transform: translate(0px, 0px) scale(1); }
  }

  .animate-blob {
    animation: blob 15s infinite alternate;
  }

  /* Animation delays */
  .animation-delay-1500 { animation-delay: 1.5s; }
  .animation-delay-2000 { animation-delay: 2s; }
  .animation-delay-3000 { animation-delay: 3s; }
  .animation-delay-4000 { animation-delay: 4s; }
  .animation-delay-6000 { animation-delay: 6s; }

  /* Hero image styling */
  .hero-image {
    transition: transform 0.5s ease;
  }

  .hero-image:hover {
    transform: scale(1.02);
  }
</style>

<script>
  import { gsap } from "gsap";
  import { ScrollToPlugin } from "gsap/ScrollToPlugin";
  import { BlurPlugin } from "@/utils/gsap-blur";
  import { LifecycleManager } from "@/utils/lifecycle-manager";

  gsap.registerPlugin(ScrollToPlugin, BlurPlugin);

  const lm = new LifecycleManager();

  lm.onElementLoaded("hero", (ctx) => {
    ctx?.add(() => {
      // Reveal text elements
      gsap.to("[data-hero-reveal]", {
        blur: 0,
        delay: 0.2,
        duration: 1,
        opacity: 1,
        stagger: 0.12,
      });

      // Animate badges with a bounce effect
      gsap.from(".venue-badge, .format-badge, .date-badge", {
        scale: 0.8,
        y: -10,
        opacity: 0,
        delay: 0.5,
        duration: 0.5,
        stagger: 0.1,
        ease: "back.out(1.7)",
      });

      // Subtle animation for the hero image
      gsap.from(".hero-image", {
        scale: 1.05,
        opacity: 0.7,
        duration: 1.2,
        ease: "power2.out",
      });
    });
  });
</script>
